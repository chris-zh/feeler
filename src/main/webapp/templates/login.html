<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>宝刀网</title>

    <meta name="description" content="让你的刀永远锋利">
    <meta name="author" content="Chris Zhang">

    <link href="/resources/css/bootstrap.min.css" rel="stylesheet">
    <link href="/resources/css/style.css" rel="stylesheet">
    <script src="/resources/js/jquery.js"></script>
    <script src="/resources/js/api.js"></script>
    <script>

        var setup = function () {
            $('#id-alert-block').toggle();
        };
        var loginForm = function () {
            var keys = [
                    'username', 'password'
            ];
            var loginPrefix = 'id-input-login-';
            return formFromKeys(keys, loginPrefix);
        };

        var registerForm = function () {
            var keys = [
                    'username', 'password', 'email'
            ];
            var registerPrefix = 'id-input-register-';
            return formFromKeys(keys, registerPrefix);
        };


        var login = function () {
            var form = loginForm();
            var success = function (r) {
                if(r.success) {
                    log(r.next);
                    window.location.href = r.next;
                }else {
                    log(r.message);
                    alert(r.message);
                }
            };
            vip.login(form, success);
        };

        var register = function () {
            var form = registerForm();
            var success = function(r) {
                if(r.success) {
                    log(r.next);
//                    window.location.href = r.next;
                    $('#id-alert').toggle();
                    var successAlert = $('#id-alert-message');
                    successAlert.append("<Strong>" + r.success + "</Strong>")
                }else {
                    log(r.message);
                    alert(r.message);
                }
            };
            vip.register(form, success);
        };

        var bindActions = function () {
            $('#id-button-login').on('click', function () {
                login();
            });
            $('#id-button-register').on('click', function () {
                register();
            })
        };


        var __main = function () {
            setup();
            bindActions();
        };

        $(document).ready(function () {
            __main();
        })
    </script>

</head>
<body>
<div class="container-fluid">
    <div class="row">
        <div class="col-md-12">
            <div class="row">
                <div class="col-md-2">
                </div>
                <div class="col-md-10">
                    <div class="page-header">
                        <h1>
                            宝刀网
                            <small>让你的刀永远锋利</small>
                        </h1>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-2">
                </div>
                <div class="col-md-8">
                    <div class="alert alert-success alert-dismissable" id="id-alert-block">

                        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">
                            ×
                        </button>
                        <div id="id-alert-message"></div>
                    </div>
                    <div class="tabbable" id="tabs-176498">
                        <ul class="nav nav-tabs">
                            <li class="active">
                                <a href="#panel-login" data-toggle="tab">登录</a>
                            </li>
                            <li>
                                <a href="#panel-register" data-toggle="tab">注册</a>
                            </li>
                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane active" id="panel-login">
                                <form role="form">
                                    <div class="form-group">

                                        <label for="id-input-login-username">
                                            用户名
                                        </label>
                                        <input type="text" class="form-control" id="id-input-login-username"/>
                                    </div>
                                    <div class="form-group">

                                        <label for="id-input-login-password">
                                            密码
                                        </label>
                                        <input type="password" class="form-control" id="id-input-login-password"/>
                                    </div>
                                    <div class="checkbox">

                                        <label>
                                            <input type="checkbox"/> 记住我
                                        </label>
                                    </div>
                                    <button type="submit" class="btn btn-default" id="id-button-login">
                                        登录
                                    </button>
                                </form>
                            </div>
                            <div class="tab-pane" id="panel-register">
                                <form role="form">
                                    <div class="form-group">

                                        <label for="id-input-register-username">
                                            用户名
                                        </label>
                                        <input type="text" class="form-control" id="id-input-register-username"/>
                                    </div>
                                    <div class="form-group">

                                        <label for="id-input-register-password">
                                            密码
                                        </label>
                                        <input type="password" class="form-control" id="id-input-register-password"/>
                                    </div>
                                    <div class="form-group">

                                        <label for="id-input-register-email">
                                            邮箱
                                        </label>
                                        <input type="email" class="form-control" id="id-input-register-email"/>
                                    </div>
                                    <button type="submit" class="btn btn-default" id="id-button-register">
                                        注册
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-2">
                </div>
            </div>
        </div>
    </div>
</div>
<script src="/resources/js/bootstrap.min.js"></script>
<script src="/resources/js/scripts.js"></script>
</body>
</html>